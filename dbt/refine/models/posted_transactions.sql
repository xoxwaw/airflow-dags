SELECT fnx009.p9_dw009_stmt_no                      AS statement_number,
       fnx009.fx_dw009_txn_id                       AS transaction_id,
       fnx009.p9_dw009_seq_no                       AS sequence_number,
       fnx009.px_dw009_urn                          AS finexus_user_id,
       fnx009.p9_dw009_prin_crn                     AS principal_crn,
       fnx009.p9_dw009_own_crn                      AS own_crn,
       fnx009.f9_dw009_upd_tms                      AS updated_timestamp_dw009,
       fnx009.f9_dw009_stmt_mth                     AS statement_month,
       PARSE_DATE('%Y%m%d', fnx009.p9_dw009_pst_dt) AS posted_date,
       PARSE_DATE('%Y%m%d', fnx009.f9_dw009_txn_dt) AS transaction_date,
       CAST(fnx009.f9_dw009_amt_lcl_crncy AS INT64) AS idr_transaction_amount,
       CAST(fnx009.f9_dw009_txn_amt AS INT64)       AS original_transaction_amount,
       fnx009.f9_dw009_txn_crncy_cde                AS original_transaction_currency_code,
       fnx009.f9_dw009_txn_cde                      AS transaction_code,
       fnx009.fx_dw009_txn_desc                     AS transaction_description,
       fnx009.fx_dw009_pem                          AS pos_mode_code,
       --need logic to parse decimals
       CAST(fnx009.f9_dw009_setl_amt AS INT64)      AS settled_amount,
       fnx009.f9_dw009_setl_crncy_cde               AS settled_currency_code,
       CAST(fnx009.f9_dw009_comm_chrg AS INT64)     AS commission_charge,
       fnx009.fx_dw009_crdh_id_meth                 AS cardholder_id_method_code,
       fnx009.fx_dw009_merc_zip                     AS merchant_zip,
       fnx009.f9_dw009_mcc                          AS merchant_category_code,
       fnx009.fx_dw009_mid                          AS merchant_id,
       fnx009.fx_dw009_apv_cde                      AS approval_code,
       fnx009.fx_dw009_adj_cde                      AS adjustment_code,
       fnx009.fx_dw009_arn                          AS acquirer_reference_number,
       fnx009.fx_dw009_tid                          AS pos_id,
       fnx009.f9_dw009_iss_crncy_cde                AS issuer_currency,
       fnx009.f9_dw009_snd_ica                      AS acquirer_id,
       fnx009.fx_dw009_eci_sec_lvl                  AS ecom_indicator,
       fnx009.fx_dw009_pymt_cde                     AS payment_code
FROM ingest.dw009 AS fnx009
GROUP BY 1,
         2,
         3,
         4,
         5,
         6,
         7,
         8,
         9,
         10,
         11,
         12,
         13,
         14,
         15,
         16,
         17,
         18,
         19,
         20,
         21,
         22,
         23,
         24,
         25,
         26,
         27,
         28,
         29,
         30,
         31
